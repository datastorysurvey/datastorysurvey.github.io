(function(){"use strict";var e={7308:function(e,t,r){var n=r(9242),a=r(3396);const s={class:"container"},i=(0,a._)("h2",null,"The Corpus of Papers in Data Storytelling",-1),o={class:"row"},c={class:"col-2"},l={class:"col-10"};function d(e,t,r,n,d,h){const p=(0,a.up)("PaperList"),u=(0,a.up)("PaperView");return(0,a.wg)(),(0,a.iD)("div",s,[i,(0,a._)("div",o,[(0,a._)("div",c,[(0,a.Wm)(p,{onPaperSelect:t[0]||(t[0]=e=>d.selectedPaperId=e)})]),(0,a._)("div",l,[(0,a.Wm)(u,{id:d.selectedPaperId},null,8,["id"])])])])}var h=r(7139);const p={class:"table-container"},u=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"Paper ID"),(0,a._)("th",null,"Title"),(0,a._)("th",null,"Type")])],-1),f=["onClick"],m={key:1};function y(e,t,r,n,s,i){return(0,a.wg)(),(0,a.iD)("div",p,[(0,a._)("table",null,[u,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.papers,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.paperID},[(0,a._)("td",null,[i.isClickable(e.paperID)?((0,a.wg)(),(0,a.iD)("a",{key:0,onClick:t=>i.selectPaper(e.paperID),class:(0,h.C_)({clickable:!0,selected:s.selectedId===e.paperID})},(0,h.zw)(e.paperID),11,f)):((0,a.wg)(),(0,a.iD)("span",m,(0,h.zw)(e.paperID),1))]),(0,a._)("td",null,(0,h.zw)(e.title),1),(0,a._)("td",null,(0,h.zw)(e.type),1)])))),128))])])])}r(1439),r(7585),r(5315);var w=r(7092),v={data(){return{papers:[],selectedId:null}},methods:{isClickable(e){return"tbd"!==e&&"book"!==e},async processExcel(){const e=await fetch("./paper_list.xlsx"),t=await e.arrayBuffer(),r=new Uint8Array(t),n=(0,w.ij)(r,{type:"array"}),a=n.Sheets[n.SheetNames[0]];this.papers=w.P6.sheet_to_json(a)},selectPaper(e){this.selectedId=e,this.$emit("paper-select",e)}},created(){this.processExcel()}},g=r(89);const b=(0,g.Z)(v,[["render",y]]);var _=b;const S={id:"content",ref:"content"},x=["src"],D={key:1};function k(e,t,r,n,s,i){return(0,a.wg)(),(0,a.iD)("div",S,[(0,a._)("button",{onClick:t[0]||(t[0]=(...e)=>i.toggleMode&&i.toggleMode(...e)),class:"switch-mode-button"},"Switch Mode"),"html"===s.mode?((0,a.wg)(),(0,a.iD)("iframe",{key:0,src:s.htmlUrl,id:"my-iframe",ref:"myIframe"},null,8,x)):((0,a.wg)(),(0,a.iD)("div",D,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.extractedSentences,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{key:t},[(0,a._)("h3",null,(0,h.zw)(e.keyword),1),(0,a._)("p",{ref_for:!0,ref:"sentenceParagraph"},(0,h.zw)(e.sentences||""),513)])))),128))]))],512)}r(6229),r(7330),r(2062);var P=r(65),$=r(4161),I=r(1445),E=r.n(I),O={name:"PaperView",data(){return{htmlUrl:"",paperHtml:"",mode:"html",scrollPosition:0,keywords:["data storytelling","data story","narrative visualization","data-driven storytelling","storytelling with data","data stories","data news","data-driven news"]}},computed:{...(0,P.rn)(["extractedSentencesData"]),extractedSentences(){return this.extractedSentencesData.filter((e=>e.paperID===this.id))}},props:{id:{type:String,required:!0}},watch:{id(e){this.fetchPaper(e)},mode(e,t){"html"===t&&this.$el.querySelector("iframe").removeEventListener("load",this.highlightKeywords),"html"===e&&this.$nextTick((()=>{this.$el.querySelector("iframe").addEventListener("load",this.highlightKeywords)}))}},methods:{toggleMode(){this.mode="html"===this.mode?"extract_sentence":"html","extract_sentence"===this.mode&&this.$nextTick((()=>{this.$refs.content.scrollTop=this.scrollPosition}))},fetchPaper(e){var t=this;console.log(`${e} is clicked`),$.Z.get(`paperdocs/${e}.html`).then((e=>{t.paperHtml=e.data;const r=new Blob([t.paperHtml],{type:"text/html"});t.htmlUrl=URL.createObjectURL(r)})).catch((r=>{r&&r.response&&404===r.response.status?$.Z.get(`paperdocs/${e}.pdf`,{responseType:"blob"}).then((e=>{const r=new Blob([e.data],{type:"application/pdf"});t.htmlUrl=URL.createObjectURL(r)})).catch((t=>{console.error(`Failed to fetch paper ${e}: `,t)})):console.error(`Failed to fetch paper ${e}: `,r)}))},highlightKeywords(){if("extract_sentence"===this.mode)this.$nextTick((()=>{this.extractedSentences.forEach(((e,t)=>{const r=this.$refs.sentenceParagraph[t],n=new(E())(r);this.keywords.forEach((function(e){n.mark(e,{diacritics:!1,separateWordSearch:!1,acrossElements:!0,caseSensitive:!1})}))}))}));else{const e=this.$el.querySelector("iframe").contentDocument,t=new(E())(e.body);this.keywords.forEach((function(e){t.mark(e,{diacritics:!1,separateWordSearch:!1,acrossElements:!0,caseSensitive:!1})}))}},handleScroll(){"extract_sentence"===this.mode&&(this.scrollPosition=this.$refs.content.scrollTop,console.log(this.scrollPosition))}},mounted(){this.$refs.myIframe&&this.$refs.myIframe.addEventListener("load",this.highlightKeywords),this.$refs.content.addEventListener("scroll",this.handleScroll)},beforeUnmount(){this.$refs.myIframe&&this.$refs.myIframe.removeEventListener("load",this.highlightKeywords),this.$refs.content.removeEventListener("scroll",this.handleScroll)},created(){this.id&&this.fetchPaper(this.id)},updated(){this.highlightKeywords()}};const j=(0,g.Z)(O,[["render",k],["__scopeId","data-v-7a22e9c1"]]);var T=j,L={name:"App",data(){return{selectedPaperId:null}},components:{PaperList:_,PaperView:T},created(){this.$store.dispatch("loadExtractedSentencesData")}};const U=(0,g.Z)(L,[["render",d]]);var C=U,K=(r(2166),(0,P.MT)({state:{extractedSentencesData:[]},mutations:{setExtractedSentencesData(e,t){e.extractedSentencesData=t}},actions:{async loadExtractedSentencesData({commit:e}){const t=await fetch("./extract_sentence.xlsx"),r=await t.arrayBuffer(),n=new Uint8Array(r),a=(0,w.ij)(n,{type:"array"}),s=a.Sheets[a.SheetNames[0]],i=w.P6.sheet_to_json(s);e("setExtractedSentencesData",i)}}}));const M=(0,n.ri)(C);M.use(K),M.mount("#app")}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}r.m=e,function(){var e=[];r.O=function(t,n,a,s){if(!n){var i=1/0;for(d=0;d<e.length;d++){n=e[d][0],a=e[d][1],s=e[d][2];for(var o=!0,c=0;c<n.length;c++)(!1&s||i>=s)&&Object.keys(r.O).every((function(e){return r.O[e](n[c])}))?n.splice(c--,1):(o=!1,s<i&&(i=s));if(o){e.splice(d--,1);var l=a();void 0!==l&&(t=l)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[n,a,s]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};r.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,s,i=n[0],o=n[1],c=n[2],l=0;if(i.some((function(t){return 0!==e[t]}))){for(a in o)r.o(o,a)&&(r.m[a]=o[a]);if(c)var d=c(r)}for(t&&t(n);l<i.length;l++)s=i[l],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return r.O(d)},n=self["webpackChunkeasyread"]=self["webpackChunkeasyread"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=r.O(void 0,[998],(function(){return r(7308)}));n=r.O(n)})();
//# sourceMappingURL=app.c7def57d.js.map