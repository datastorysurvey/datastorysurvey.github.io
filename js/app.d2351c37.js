(function(){"use strict";var e={854:function(e,t,r){var n=r(9242),s=r(3396);const a={class:"container"},o=(0,s._)("h2",null,"The Corpus of Papers in Data Storytelling",-1),i={class:"row"},c={class:"col-2"},l={class:"col-10"};function d(e,t,r,n,d,h){const p=(0,s.up)("PaperList"),u=(0,s.up)("PaperView");return(0,s.wg)(),(0,s.iD)("div",a,[o,(0,s._)("div",i,[(0,s._)("div",c,[(0,s.Wm)(p,{onPaperSelect:t[0]||(t[0]=e=>d.selectedPaperId=e)})]),(0,s._)("div",l,[(0,s.Wm)(u,{id:d.selectedPaperId},null,8,["id"])])])])}var h=r(7139);const p={style:{"margin-bottom":"1rem"}},u=(0,s._)("label",{for:"coderFilter"},"Filter by coder: ",-1),f=(0,s._)("option",{value:""},"All coders",-1),m=["value"],y={class:"table-container"},w=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"Paper ID"),(0,s._)("th",null,"Title"),(0,s._)("th",null,"Type")])],-1),v=["onClick"],g={key:1};function b(e,t,r,a,o,i){return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",p,[u,(0,s.wy)((0,s._)("select",{id:"coderFilter","onUpdate:modelValue":t[0]||(t[0]=e=>o.selectedCoder=e)},[f,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.uniqueCoders,(e=>((0,s.wg)(),(0,s.iD)("option",{key:e,value:e},(0,h.zw)(e),9,m)))),128))],512),[[n.bM,o.selectedCoder]])]),(0,s._)("div",y,[(0,s._)("table",null,[w,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.filteredPapers,(e=>((0,s.wg)(),(0,s.iD)("tr",{key:e.paperID},[(0,s._)("td",null,[i.isClickable(e.paperID)?((0,s.wg)(),(0,s.iD)("a",{key:0,onClick:t=>i.selectPaper(e.paperID),class:(0,h.C_)({clickable:!0,selected:o.selectedId===e.paperID})},(0,h.zw)(e.paperID),11,v)):((0,s.wg)(),(0,s.iD)("span",g,(0,h.zw)(e.paperID),1))]),(0,s._)("td",null,(0,h.zw)(e.title),1),(0,s._)("td",null,(0,h.zw)(e.type),1)])))),128))])])])])}r(1439),r(7585),r(5315);var _=r(7092),S={data(){return{papers:[],selectedId:null,selectedCoder:""}},computed:{uniqueCoders(){const e=this.papers.map((e=>e.coder)).filter((e=>null!=e&&""!==e));return Array.from(new Set(e)).sort()},filteredPapers(){return this.selectedCoder?this.papers.filter((e=>e.coder===this.selectedCoder)):this.papers}},methods:{isClickable(e){return"tbd"!==e&&"book"!==e},async processExcel(){const e=await fetch("./paper_list.xlsx"),t=await e.arrayBuffer(),r=new Uint8Array(t),n=(0,_.ij)(r,{type:"array"}),s=n.Sheets[n.SheetNames[0]];this.papers=_.P6.sheet_to_json(s)},selectPaper(e){this.selectedId=e,this.$emit("paper-select",e)}},created(){this.processExcel()}},x=r(89);const D=(0,x.Z)(S,[["render",b]]);var P=D;const k={id:"content",ref:"content"},$=["src"],I={key:1};function E(e,t,r,n,a,o){return(0,s.wg)(),(0,s.iD)("div",k,[(0,s._)("button",{onClick:t[0]||(t[0]=(...e)=>o.toggleMode&&o.toggleMode(...e)),class:"switch-mode-button"},"Switch Mode"),"html"===a.mode?((0,s.wg)(),(0,s.iD)("iframe",{key:0,src:a.htmlUrl,id:"my-iframe",ref:"myIframe"},null,8,$)):((0,s.wg)(),(0,s.iD)("div",I,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.extractedSentences,((e,t)=>((0,s.wg)(),(0,s.iD)("div",{key:t},[(0,s._)("h3",null,(0,h.zw)(e.keyword),1),(0,s._)("p",{ref_for:!0,ref:"sentenceParagraph"},(0,h.zw)(e.sentences||""),513)])))),128))]))],512)}r(6229),r(7330),r(2062);var C=r(65),O=r(4161),j=r(1445),T=r.n(j),L={name:"PaperView",data(){return{htmlUrl:"",paperHtml:"",mode:"html",scrollPosition:0,keywords:["data storytelling","data story","narrative visualization","data-driven storytelling","storytelling with data","data stories","data news","data-driven news","story","narrative","structure","character","stories","sequence"]}},computed:{...(0,C.rn)(["extractedSentencesData"]),extractedSentences(){return this.extractedSentencesData.filter((e=>e.paperID===this.id))}},props:{id:{type:String,required:!0}},watch:{id(e){this.fetchPaper(e)},mode(e,t){"html"===t&&this.$el.querySelector("iframe").removeEventListener("load",this.highlightKeywords),"html"===e&&this.$nextTick((()=>{this.$el.querySelector("iframe").addEventListener("load",this.highlightKeywords)}))}},methods:{toggleMode(){this.mode="html"===this.mode?"extract_sentence":"html","extract_sentence"===this.mode&&this.$nextTick((()=>{this.$refs.content.scrollTop=this.scrollPosition}))},fetchPaper(e){var t=this;console.log(`${e} is clicked`),O.Z.get(`paperdocs/${e}.html`).then((e=>{t.paperHtml=e.data;const r=new Blob([t.paperHtml],{type:"text/html"});t.htmlUrl=URL.createObjectURL(r)})).catch((r=>{r&&r.response&&404===r.response.status?O.Z.get(`paperdocs/${e}.pdf`,{responseType:"blob"}).then((e=>{const r=new Blob([e.data],{type:"application/pdf"});t.htmlUrl=URL.createObjectURL(r)})).catch((t=>{console.error(`Failed to fetch paper ${e}: `,t)})):console.error(`Failed to fetch paper ${e}: `,r)}))},highlightKeywords(){if("extract_sentence"===this.mode)this.$nextTick((()=>{this.extractedSentences.forEach(((e,t)=>{const r=this.$refs.sentenceParagraph[t],n=new(T())(r);this.keywords.forEach((function(e){n.mark(e,{diacritics:!1,separateWordSearch:!1,acrossElements:!0,caseSensitive:!1})}))}))}));else{const e=this.$el.querySelector("iframe").contentDocument,t=new(T())(e.body);this.keywords.forEach((function(e){t.mark(e,{diacritics:!1,separateWordSearch:!1,acrossElements:!0,caseSensitive:!1})}))}},handleScroll(){"extract_sentence"===this.mode&&(this.scrollPosition=this.$refs.content.scrollTop,console.log(this.scrollPosition))}},mounted(){this.$refs.myIframe&&this.$refs.myIframe.addEventListener("load",this.highlightKeywords),this.$refs.content.addEventListener("scroll",this.handleScroll)},beforeUnmount(){this.$refs.myIframe&&this.$refs.myIframe.removeEventListener("load",this.highlightKeywords),this.$refs.content.removeEventListener("scroll",this.handleScroll)},created(){this.id&&this.fetchPaper(this.id)},updated(){this.highlightKeywords()}};const U=(0,x.Z)(L,[["render",E],["__scopeId","data-v-56ad50a6"]]);var K=U,M={name:"App",data(){return{selectedPaperId:null}},components:{PaperList:P,PaperView:K},created(){this.$store.dispatch("loadExtractedSentencesData")}};const z=(0,x.Z)(M,[["render",d]]);var q=z,F=(r(2166),(0,C.MT)({state:{extractedSentencesData:[]},mutations:{setExtractedSentencesData(e,t){e.extractedSentencesData=t}},actions:{async loadExtractedSentencesData({commit:e}){const t=await fetch("./extract_sentence.xlsx"),r=await t.arrayBuffer(),n=new Uint8Array(r),s=(0,_.ij)(n,{type:"array"}),a=s.Sheets[s.SheetNames[0]],o=_.P6.sheet_to_json(a);e("setExtractedSentencesData",o)}}}));const H=(0,n.ri)(q);H.use(F),H.mount("#app")}},t={};function r(n){var s=t[n];if(void 0!==s)return s.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,r),a.exports}r.m=e,function(){var e=[];r.O=function(t,n,s,a){if(!n){var o=1/0;for(d=0;d<e.length;d++){n=e[d][0],s=e[d][1],a=e[d][2];for(var i=!0,c=0;c<n.length;c++)(!1&a||o>=a)&&Object.keys(r.O).every((function(e){return r.O[e](n[c])}))?n.splice(c--,1):(i=!1,a<o&&(o=a));if(i){e.splice(d--,1);var l=s();void 0!==l&&(t=l)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[n,s,a]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};r.O.j=function(t){return 0===e[t]};var t=function(t,n){var s,a,o=n[0],i=n[1],c=n[2],l=0;if(o.some((function(t){return 0!==e[t]}))){for(s in i)r.o(i,s)&&(r.m[s]=i[s]);if(c)var d=c(r)}for(t&&t(n);l<o.length;l++)a=o[l],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(d)},n=self["webpackChunkeasyread"]=self["webpackChunkeasyread"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=r.O(void 0,[998],(function(){return r(854)}));n=r.O(n)})();
//# sourceMappingURL=app.d2351c37.js.map